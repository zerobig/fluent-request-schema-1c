---
sidebar_position: 7
tags: [Функционал]
---

# Виртуальные таблицы

```bsl
Запрос = СхЗапрос.НовыйЗапрос("РегистрСведений.КурсыВалют.СрезПоследних")
  .ВТаблицуЗначений();
```

## Параметры виртульных таблиц

```bsl
МассивПараметров = Новый Массив;
МассивПараметров.Добавить(Новый Структура("ИмяПараметра, Значение",
  "НаДату", ТекущаяДатаСеанса()));

Запрос = СхЗапрос.НовыйЗапрос("РегистрСведений.КурсыВалют.СрезПоследних")
  // highlight-next-line
  .ПараметрВиртуальнойТаблицы(1, "&НаДату")
  .Параметры(МассивПараметров)
  .ВТаблицуЗначений();
```

## Условия в параметрах виртульных таблиц

### Предикатом

```bsl
МассивПараметров = Новый Массив;
МассивПараметров.Добавить(Новый Структура("ИмяПараметра, Значение",
  "НаДату", ТекущаяДатаСеанса()));

ТаблицаЗначений = СхЗапрос.НовыйЗапрос("РегистрСведений.КурсыВалют.СрезПоследних")
  .ПараметрВиртуальнойТаблицы(1, "&НаДату")
  // highlight-start
  .ПараметрВиртуальнойТаблицы(2, СхЗапрос.Предикат()
    .Реквизит("Валюта").Равно(Валюта))
  // highlight-end
  .Параметры(МассивПараметров)
  .ВТаблицуЗначений()
;
```

### Строкой

```bsl
МассивПараметров = Новый Массив;
МассивПараметров.Добавить(Новый Структура("ИмяПараметра, Значение",
  "НаДату", ТекущаяДатаСеанса()));
МассивПараметров.Добавить(Новый Структура("ИмяПараметра, Значение",
  "Валюта", Валюта));

ТаблицаЗначений = СхЗапрос.НовыйЗапрос("РегистрСведений.КурсыВалют.СрезПоследних")
  .ПараметрВиртуальнойТаблицы(1, "&НаДату")
  // highlight-next-line
  .ПараметрВиртуальнойТаблицы(2, "Валюта = &Валюта")
  .Параметры(МассивПараметров)
  .ВТаблицуЗначений()
;
```
